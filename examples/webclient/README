Some of the code for this was from another project that I worked on a while ago.  Please bear with me as I clean it up for this one.
